# 모의해킹 대응 플로우 (Pen-test Response Playbook)

모의해킹팀이 사용하는 표현을 **보안팀 액션 단위**로 번역한 문서.

---

## 1. 용어 해석

- **코드 따오기**
  - 공격에 사용된 스크립트·실행파일 원문 확보
  - 예: Defender 알림, PowerShell ScriptBlock 로그(4104), EDR 로그에서 코드 복원

- **전원 분리**
  - 네트워크 격리 또는 실제 전원 차단
  - EDR에서 `isolate machine`, NSG/방화벽 룰로 inbound/outbound 차단

- **대역대 확인**
  - 동일 Subnet / VLAN 내 다른 호스트 감염 여부 확인

- **방 분리**
  - 네트워크 세그먼트, VLAN, 라우팅/ACL 수정으로 특정 구간을 따로 떼어냄

- **스캔**
  - AV/EDR Full Scan
  - nmap, Trivy, osquery, YARA 등으로 선별적 점검

- **로그 분석**
  - 이벤트 로그, Defender·EDR 로그, NSG/WAF 로그를 활용한 타임라인 분석

---

## 2. 표준 대응 순서

1. **1단계 – 격리 & 증거 보전**
   - 의심 단말 네트워크 격리
   - VM 스냅샷 / 디스크 복제

2. **2단계 – 포털에서 1차 상황 파악**
   - 어떤 파일·프로세스·IP·계정이 연관됐는지 확인
   - 동일 IOC로 다른 경고 없는지 체크

3. **3단계 – 서버 로컬 점검**
   - 이벤트 로그, 프로세스, netstat, 서비스, 시작프로그램 수집
   - 최근 변경 파일 목록 추출

4. **4단계 – 코드 따오기**
   - 악성 스크립트·실행파일을 별도 폴더에 복사
   - 해시(SHA256)·경로·타임스탬프 기록

5. **5단계 – 동일 대역 스캔**
   - 같은 Subnet 대상 osquery / Trivy / YARA / nmap 수행
   - 의심 징후 있으면 동일 격리·조치

6. **6단계 – 타임라인 & 영향 범위**
   - `시간 – 이벤트 – 계정/프로세스/IP – 근거 로그` 형태 표 작성
   - 피해 자산·데이터 범위 정의

7. **7단계 – 최종 조치 & 재발 방지**
   - 패치, 재설치, 비밀번호/키 교체
   - 방화벽/NSG/정책 강화
   - 모니터링 룰·EDR 규칙 추가
   - 보고서 및 관리대장 작성

이 문서는 “모의해킹팀이 말하는 순서를 실제로 어떻게 실행할지” 정리한 플레이북이다.
